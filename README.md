# CSML_TextBot
The source code for my chat-bot that convert image to text and also able to translate it

CSML Текстбот - чат-бот для распознавания и перевода текста с картинок и документов, а так же простого перевода текста.
Позволяет избежать перепечатывания текста или понять что написано на фотографии. Легко встраивается в самые популярные мессенджеры.<br/>
Потестировать бот можно тут https://chat.csml.dev/channels/0kv4xowrzaykaccw3qbqiosicmok4r3l<br/>
Видео демонстрация тут: https://yadi.sk/i/qJ91BHhy8Iip7A

Проект написан на языке CSML и python (back-end)
CSML - Conversational Standard Meta Language, это опенсорсный язык программирования, созданный специально для чат-ботов компанией Clevy.
Интерпретатор для этого языка и всю документацию можно найти по этому адресу: https://studio.csml.dev/
Идея CSML в том, что бы можно было использовать один код для множества мессенджеров, интегрируя свой продукт в них с помощью API.
На языке python выполнена функциональная часть бота, для его работы используются сервисы Yandex.vision.
Скрипты хранятся и выполняются на AWS lambda, и часть серверов на территории РФ заблокирована, поэтому для загрузки файлов (как архивов со скриптами,
так и файлов для чат-бота при работе в веб-версии) требуется использовать сервисы обхода блокировок.
Принцип работы бота:
- Первичная настройка, включает в себя:
  1.Выбор языка, на котором бот будет с Вами общаться.
  2.Выбор языков, наиболее часто используемых Вами для перевода (например: Английский, Русский, Немецкий)
  эти данные хранятся в статической переменной, и при повторном вызове бот их не спросит без спецкоманды '/reset'
- Основной цикл программы:
<br>1. Загрузка файла или ввод текста // бот определяет контекст ввода - ссылка или текст с помощью регулярного выражения<br/>
<br>2. В зависимости от типа ввода:</br>
 <br>А. <b>Распознавание:</b> бот предлагает выбрать язык из ранее выбранного списка или оставить оригинал.<br/>
        - ссылка отправляется в виде аргумета в функцию get_text, в которой происходит кодирование файла, формирование запроса и получения ответа
        в виде json форматированного сообщения, вполняется парсинг и функция возвращает готовый текст в виде строки.
        - если выбрана опция перевода, текст отправляется в функцию translate.<br/>
 <br>Б. <b>Перевод:</b> бот предлагает выбрать язык из выбранного ранее списка<br/>
        - текст отправляется в функцию translate в виде аргумента, где формируется json и отправляется запрос к сервису. Полученый в ответ json парсится и
        возвращается функцией в виде строки.<br/>
<br>3. Бот выводит результат и ждет следующий ввод.<br/> <br/>
- В этой версии так же реализован инструмент для тестирования: через 10 основных циклов предлагается оставить фидбек разработикам, задается несколько вопросов.
  Массив из ответов отправляется c помощью webhook в мессенджер разработчика.
  
Для запуска программы необходимо склонировать проект и запустить команду "./compress" в верхней директории проекта.
Скрипт создаст 2 архива, в каждом из которых нужно будет добавить значения Вашего API ключа для Яндекс в файл .env
Код из файла textbot.csml нужно скопировать в основной поток Вашего бота (https://studio.csml.dev/), а архивы с функциями загрузить в раздел functions,
прописав следующие настройки в полях для функций get_text и translate соотвественно: function name:  get_text и translate; Handler: index.main (для обеих); 
Runtime: python 3.6; Arguments: url= и lang=, string=;
  Бот готов к работе.
  
  
